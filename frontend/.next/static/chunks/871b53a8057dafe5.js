(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69638,e=>{"use strict";let a=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>a],69638)},31278,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},63059,e=>{"use strict";let a=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>a],63059)},42129,69570,e=>{"use strict";var a=e.i(43476),t=e.i(932),s=e.i(71645),r=e.i(22016),l=e.i(57688),i=e.i(75157),n=e.i(9666),c=e.i(37727),d=e.i(31278),o=e.i(69638),m=e.i(9165);let x={first_name:"",last_name:"",phone_number:"",email:"",national_id:"",town_of_residence:"",sacco_id:"",payment_timeline_id:"",customer_notes:""};function u({isOpen:e,onClose:t,product:r,variationId:l}){let[n,u]=(0,s.useState)(x),[p,g]=(0,s.useState)([]),[h,y]=(0,s.useState)([]),[f,b]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),[v,_]=(0,s.useState)(!1),[w,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&(b(!0),Promise.all([m.default.get("/financing/saccos/"),m.default.get("/financing/payment-timelines/")]).then(([e,a])=>{g(e.data.results||e.data),y(a.data.results||a.data)}).catch(e=>{console.error("Error fetching data:",e),k("Failed to load financing options")}).finally(()=>b(!1)))},[e]),(0,s.useEffect)(()=>{e||(u(x),_(!1),k(null))},[e]);let C=e=>{let{name:a,value:t}=e.target;u(e=>({...e,[a]:t})),k(null)},S=async e=>{e.preventDefault(),N(!0),k(null);try{await m.default.post("/financing/financing-requests/",{product:r.id,variation:l||null,sacco:parseInt(n.sacco_id),payment_timeline:parseInt(n.payment_timeline_id),first_name:n.first_name,last_name:n.last_name,phone_number:n.phone_number,email:n.email,national_id:n.national_id,town_of_residence:n.town_of_residence,customer_notes:n.customer_notes}),_(!0)}catch(e){k(e.response?.data?.detail||"Failed to submit request. Please try again.")}finally{N(!1)}};return e?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:t}),(0,a.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:v?"Request Submitted!":"Select Financing"}),(0,a.jsx)("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(c.X,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-[calc(90vh-80px)]",children:f?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(d.Loader2,{className:"w-8 h-8 text-primary-600 animate-spin"})}):v?(0,a.jsxs)("div",{className:"p-6 text-center",children:[(0,a.jsx)(o.CheckCircle,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Thank You!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"We have received your information and we'll get back to you as soon as possible."}),(0,a.jsx)("button",{onClick:t,className:"px-6 py-3 bg-primary-600 text-white rounded-lg font-medium hover:bg-primary-700 transition-colors",children:"Close"})]}):(0,a.jsxs)("form",{onSubmit:S,className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Selected Product"}),(0,a.jsx)("p",{className:"font-medium text-gray-900",children:r.name}),(0,a.jsx)("p",{className:"text-primary-600 font-semibold",children:(0,i.formatPrice)(r.current_price)})]}),w&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:w}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),(0,a.jsx)("input",{type:"text",name:"first_name",value:n.first_name,onChange:C,required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),(0,a.jsx)("input",{type:"text",name:"last_name",value:n.last_name,onChange:C,required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),(0,a.jsx)("input",{type:"tel",name:"phone_number",value:n.phone_number,onChange:C,placeholder:"e.g., 0712345678",required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),(0,a.jsx)("input",{type:"email",name:"email",value:n.email,onChange:C,required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"National ID Number *"}),(0,a.jsx)("input",{type:"text",name:"national_id",value:n.national_id,onChange:C,required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Town of Residence *"}),(0,a.jsx)("input",{type:"text",name:"town_of_residence",value:n.town_of_residence,onChange:C,placeholder:"e.g., Nairobi, Mombasa, Kisumu",required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"Financing Options"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sacco of Your Choice *"}),(0,a.jsxs)("select",{name:"sacco_id",value:n.sacco_id,onChange:C,required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Select a Sacco"}),p.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preferred Payment Timeline *"}),(0,a.jsxs)("select",{name:"payment_timeline_id",value:n.payment_timeline_id,onChange:C,required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Select timeline"}),h.map(e=>(0,a.jsx)("option",{value:e.id,children:e.label},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes (Optional)"}),(0,a.jsx)("textarea",{name:"customer_notes",value:n.customer_notes,onChange:C,rows:3,className:"w-full px-4 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",placeholder:"Any additional information..."})]})]}),(0,a.jsx)("button",{type:"submit",disabled:j,className:(0,i.cn)("w-full py-3 rounded-lg font-medium text-white transition-all",j?"bg-gray-400 cursor-not-allowed":"bg-primary-600 hover:bg-primary-700"),children:j?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsx)(d.Loader2,{className:"w-5 h-5 mr-2 animate-spin"}),"Submitting..."]}):"Submit Financing Request"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"By submitting, you agree to our Terms of Service and Privacy Policy. Your information will be shared with the selected Sacco for processing."})]})})]})]}):null}function p(e){let c,d,o,m,x,p,h,y,f,b,j,N,v,_,w,k,C,S,P,q,A,M,F=(0,t.c)(86),{product:z}=e,{addToCart:E}=(0,n.useCartStore)();F[0]===Symbol.for("react.memo_cache_sentinel")?(c={},F[0]=c):c=F[0];let[L,$]=(0,s.useState)(c),[R,T]=(0,s.useState)(!1),[O,B]=(0,s.useState)(!1),[H,I]=(0,s.useState)(!1);if(F[1]!==E||F[2]!==z.category_name||F[3]!==z.discount_percentage||F[4]!==z.id||F[5]!==z.main_image||F[6]!==z.name||F[7]!==z.slug||F[8]!==z.variations_summary||F[9]!==L){let e,t,s,n,c,u,f,b=z.variations_summary||{};F[17]!==E||F[18]!==z.id?(e=async()=>{let e;B(!0),(await E(z.id,e,1)).success&&(I(!0),setTimeout(()=>I(!1),3e3)),B(!1)},F[17]=E,F[18]=z.id,F[19]=e):e=F[19],d=e,h="group bg-white rounded-2xl p-4 shadow-sm transition-all duration-300 hover:shadow-xl";let j=`/product/${z.slug}`;F[20]!==z.main_image?(t=(0,i.getImageUrl)(z.main_image),F[20]=z.main_image,F[21]=t):t=F[21],F[22]!==z.name||F[23]!==t?(s=(0,a.jsx)(l.default,{src:t,alt:z.name,fill:!0,className:"object-contain p-4 group-hover:scale-105 transition-transform duration-300",sizes:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 25vw",unoptimized:!0}),F[22]=z.name,F[23]=t,F[24]=s):s=F[24],F[25]!==z.discount_percentage?(n=z.discount_percentage>0&&(0,a.jsxs)("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-medium rounded",children:["-",z.discount_percentage,"%"]}),F[25]=z.discount_percentage,F[26]=n):n=F[26],F[27]!==n?(c=(0,a.jsx)("div",{className:"absolute top-2 left-2 flex flex-col gap-1",children:n}),F[27]=n,F[28]=c):c=F[28],F[29]!==s||F[30]!==c?(u=(0,a.jsxs)("div",{className:"relative aspect-square bg-gray-50 rounded-xl overflow-hidden mb-4",children:[s,c]}),F[29]=s,F[30]=c,F[31]=u):u=F[31],F[32]!==u||F[33]!==j?(y=(0,a.jsx)(r.default,{href:j,className:"block relative",children:u}),F[32]=u,F[33]=j,F[34]=y):y=F[34],o="space-y-3",F[35]!==z.category_name?(m=z.category_name&&(0,a.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:z.category_name}),F[35]=z.category_name,F[36]=m):m=F[36];let N=`/product/${z.slug}`;F[37]!==z.name?(f=(0,a.jsx)("h3",{className:"font-medium text-gray-900 line-clamp-2 min-h-[2.5rem] hover:text-primary-600 transition-colors",children:z.name}),F[37]=z.name,F[38]=f):f=F[38],F[39]!==N||F[40]!==f?(x=(0,a.jsx)(r.default,{href:N,children:f}),F[39]=N,F[40]=f,F[41]=x):x=F[41],p=Object.keys(b).length>0&&(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(b).filter(g).map(e=>{let[t,s]=e;return(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[s.slice(0,3).map(e=>(0,a.jsx)("button",{onClick:()=>{var a;return a=e.id,void $(e=>({...e,[t]:a}))},className:(0,i.cn)("px-2 py-1 text-xs border rounded-md transition-all",L[t]===e.id?"border-primary-600 bg-primary-50 text-primary-700":"border-gray-200 text-gray-600 hover:border-gray-300"),children:e.value},e.id)),s.length>3&&(0,a.jsxs)("span",{className:"px-2 py-1 text-xs text-gray-400",children:["+",s.length-3]})]})},t)})}),F[1]=E,F[2]=z.category_name,F[3]=z.discount_percentage,F[4]=z.id,F[5]=z.main_image,F[6]=z.name,F[7]=z.slug,F[8]=z.variations_summary,F[9]=L,F[10]=d,F[11]=o,F[12]=m,F[13]=x,F[14]=p,F[15]=h,F[16]=y}else d=F[10],o=F[11],m=F[12],x=F[13],p=F[14],h=F[15],y=F[16];F[42]!==z.current_price?(f=(0,i.formatPrice)(z.current_price),F[42]=z.current_price,F[43]=f):f=F[43],F[44]!==f?(b=(0,a.jsx)("span",{className:"text-lg font-bold text-accent",children:f}),F[44]=f,F[45]=b):b=F[45],F[46]!==z.base_price||F[47]!==z.sale_price?(j=z.sale_price&&z.base_price>z.sale_price&&(0,a.jsx)("span",{className:"text-sm text-gray-400 line-through",children:(0,i.formatPrice)(z.base_price)}),F[46]=z.base_price,F[47]=z.sale_price,F[48]=j):j=F[48],F[49]!==j||F[50]!==b?(N=(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[b,j]}),F[49]=j,F[50]=b,F[51]=N):N=F[51];let U=O||!z.is_in_stock,X=z.is_in_stock?"bg-accent text-white hover:bg-accent-dark active:scale-[0.98]":"bg-gray-100 text-gray-400 cursor-not-allowed";F[52]!==X?(v=(0,i.cn)("w-full py-3 rounded-full font-medium text-sm transition-all",X),F[52]=X,F[53]=v):v=F[53];let D=O?"Adding...":z.is_in_stock?"Buy Cash":"Out of Stock";return F[54]!==d||F[55]!==U||F[56]!==v||F[57]!==D?(_=(0,a.jsx)("button",{onClick:d,disabled:U,className:v,children:D}),F[54]=d,F[55]=U,F[56]=v,F[57]=D,F[58]=_):_=F[58],F[59]!==z.allow_financing||F[60]!==z.is_in_stock?(w=z.allow_financing&&z.is_in_stock&&(0,a.jsx)("button",{onClick:()=>T(!0),className:"w-full py-3 rounded-full font-medium text-sm border-2 border-gray-200 text-gray-700 hover:border-primary-600 hover:text-primary-600 transition-all active:scale-[0.98]",children:"Select Financing"}),F[59]=z.allow_financing,F[60]=z.is_in_stock,F[61]=w):w=F[61],F[62]!==_||F[63]!==w?(k=(0,a.jsxs)("div",{className:"space-y-2 pt-2",children:[_,w]}),F[62]=_,F[63]=w,F[64]=k):k=F[64],F[65]!==N||F[66]!==k||F[67]!==o||F[68]!==m||F[69]!==x||F[70]!==p?(C=(0,a.jsxs)("div",{className:o,children:[m,x,p,N,k]}),F[65]=N,F[66]=k,F[67]=o,F[68]=m,F[69]=x,F[70]=p,F[71]=C):C=F[71],F[72]!==H?(S=H&&(0,a.jsxs)("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-in slide-in-from-bottom fade-in duration-300",children:[(0,a.jsx)("p",{className:"font-medium",children:"Added to cart!"}),(0,a.jsx)(r.default,{href:"/cart",className:"text-sm underline",children:"View Cart"})]}),F[72]=H,F[73]=S):S=F[73],F[74]!==C||F[75]!==S||F[76]!==h||F[77]!==y?(P=(0,a.jsxs)("div",{className:h,children:[y,C,S]}),F[74]=C,F[75]=S,F[76]=h,F[77]=y,F[78]=P):P=F[78],F[79]===Symbol.for("react.memo_cache_sentinel")?(q=()=>T(!1),F[79]=q):q=F[79],F[80]!==R||F[81]!==z?(A=(0,a.jsx)(u,{isOpen:R,onClose:q,product:z}),F[80]=R,F[81]=z,F[82]=A):A=F[82],F[83]!==P||F[84]!==A?(M=(0,a.jsxs)(a.Fragment,{children:[P,A]}),F[83]=P,F[84]=A,F[85]=M):M=F[85],M}function g(e){let[a]=e;return"color"!==a.toLowerCase()}e.s(["default",()=>u],69570),e.s(["default",()=>p],42129)},47615,49582,e=>{"use strict";var a=e.i(75254);let t=(0,a.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],47615);let s=(0,a.default)("sliders-horizontal",[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]]);e.s(["SlidersHorizontal",()=>s],49582)},6695,e=>{"use strict";var a=e.i(43476),t=e.i(932),s=e.i(71645),r=e.i(18566),l=e.i(47615),i=e.i(37727),n=e.i(64659),c=e.i(63059),d=e.i(49582),o=e.i(31278),m=e.i(42129),x=e.i(9165);let u=[{value:"-created_at",label:"Newest"},{value:"created_at",label:"Oldest"},{value:"base_price",label:"Price: Low to High"},{value:"-base_price",label:"Price: High to Low"},{value:"name",label:"Name: A to Z"},{value:"-name",label:"Name: Z to A"}];function p(e){let s,r,l,i,d,o,m,x,u,g,h=(0,t.c)(40),{category:y,categorySlug:f,expandedCategories:b,toggleCategoryExpansion:j,updateParams:N,level:v}=e,_=y.children&&y.children.length>0;h[0]!==y.id||h[1]!==b?(s=b.has(y.id),h[0]=y.id,h[1]=b,h[2]=s):s=h[2];let w=s,k=f===y.slug,C=y.product_count>0;h[3]!==y.id||h[4]!==_||h[5]!==w||h[6]!==j?(r=_&&(0,a.jsx)("button",{onClick:()=>j(y.id),className:"p-1 hover:bg-gray-100 rounded mr-1","aria-label":w?"Collapse":"Expand",children:w?(0,a.jsx)(n.ChevronDown,{className:"w-3 h-3 text-gray-500"}):(0,a.jsx)(c.ChevronRight,{className:"w-3 h-3 text-gray-500"})}),h[3]=y.id,h[4]=_,h[5]=w,h[6]=j,h[7]=r):r=h[7],h[8]!==_?(l=!_&&(0,a.jsx)("span",{className:"w-5"}),h[8]=_,h[9]=l):l=h[9],h[10]!==y.slug||h[11]!==N?(i=()=>N("category",y.slug),h[10]=y.slug,h[11]=N,h[12]=i):i=h[12];let S=`flex-1 text-left py-1 text-sm truncate ${k?"text-primary font-medium":C?"text-gray-700 hover:text-gray-900":"text-gray-400"}`,P=`${8*v}px`;return h[13]!==P?(d={paddingLeft:P},h[13]=P,h[14]=d):d=h[14],h[15]!==y.product_count||h[16]!==C?(o=C&&(0,a.jsxs)("span",{className:"text-gray-400 ml-1 text-xs",children:["(",y.product_count,")"]}),h[15]=y.product_count,h[16]=C,h[17]=o):o=h[17],h[18]!==y.name||h[19]!==i||h[20]!==S||h[21]!==d||h[22]!==o?(m=(0,a.jsxs)("button",{onClick:i,className:S,style:d,children:[y.name,o]}),h[18]=y.name,h[19]=i,h[20]=S,h[21]=d,h[22]=o,h[23]=m):m=h[23],h[24]!==r||h[25]!==l||h[26]!==m?(x=(0,a.jsxs)("div",{className:"flex items-center",children:[r,l,m]}),h[24]=r,h[25]=l,h[26]=m,h[27]=x):x=h[27],h[28]!==y.children||h[29]!==f||h[30]!==b||h[31]!==_||h[32]!==w||h[33]!==v||h[34]!==j||h[35]!==N?(u=_&&w&&(0,a.jsx)("ul",{className:"ml-2 border-l border-gray-100 pl-2 space-y-0.5",children:y.children.map(e=>(0,a.jsx)(p,{category:e,categorySlug:f,expandedCategories:b,toggleCategoryExpansion:j,updateParams:N,level:v+1},e.id))}),h[28]=y.children,h[29]=f,h[30]=b,h[31]=_,h[32]=w,h[33]=v,h[34]=j,h[35]=N,h[36]=u):u=h[36],h[37]!==x||h[38]!==u?(g=(0,a.jsxs)("li",{children:[x,u]}),h[37]=x,h[38]=u,h[39]=g):g=h[39],g}function g(){let e=(0,r.useRouter)(),t=(0,r.useSearchParams)(),[n,c]=(0,s.useState)([]),[o,g]=(0,s.useState)([]),[h,y]=(0,s.useState)([]),[f,b]=(0,s.useState)(!0),[j,N]=(0,s.useState)(0),[v,_]=(0,s.useState)(!1),[w,k]=(0,s.useState)(new Set),C=t.get("category")||"",S=t.get("brand")||"",P=t.get("sort")||"-created_at",q=t.get("q")||"",A=t.get("min_price")||"",M=t.get("max_price")||"",F=parseInt(t.get("page")||"1");(0,s.useEffect)(()=>{(async()=>{try{let[e,a]=await Promise.all([x.api.get("/store/categories/"),x.api.get("/store/brands/")]);g(e.data.results||e.data||[]),y(a.data.results||a.data||[])}catch(e){console.error("Error fetching filters:",e)}})()},[]),(0,s.useEffect)(()=>{(async()=>{b(!0);try{let e=new URLSearchParams;C&&e.append("category",C),S&&e.append("brand",S),e.append("ordering",P),q&&e.append("search",q),A&&e.append("min_price",A),M&&e.append("max_price",M),e.append("page",F.toString());let a=await x.api.get(`/store/products/?${e.toString()}`);c(a.data.results||a.data||[]),N(a.data.count||a.data.length||0)}catch(e){console.error("Error fetching products:",e)}finally{b(!1)}})()},[C,S,P,q,A,M,F]);let z=(a,s)=>{let r=new URLSearchParams(t.toString());s?r.set(a,s):r.delete(a),"page"!==a&&r.delete("page"),e.push(`/shop?${r.toString()}`)},E=()=>{e.push("/shop")},L=e=>{k(a=>{let t=new Set(a);return t.has(e)?t.delete(e):t.add(e),t})};(0,s.useEffect)(()=>{if(C){let e=(a,t=[])=>{for(let s of a){if(s.slug===C)return k(e=>new Set([...e,...t])),!0;if(s.children?.length>0&&e(s.children,[...t,s.id]))return!0}return!1};e(o)}},[C,o]);let $=C||S||A||M;return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white border-b",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:q?`Search results for "${q}"`:"Shop"}),(0,a.jsxs)("p",{className:"text-gray-500 mt-2",children:[j," ",1===j?"product":"products"," found"]})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"flex gap-8",children:[(0,a.jsx)("aside",{className:"hidden lg:block w-64 flex-shrink-0",children:(0,a.jsxs)("div",{className:"sticky top-24 flex flex-col max-h-[calc(100vh-8rem)]",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-6 pr-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Categories"}),(0,a.jsxs)("ul",{className:"space-y-1",children:[(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>z("category",""),className:`w-full text-left py-1.5 text-sm ${!C?"text-primary font-medium":"text-gray-600 hover:text-gray-900"}`,children:"All Categories"})}),o.map(e=>(0,a.jsx)(p,{category:e,categorySlug:C,expandedCategories:w,toggleCategoryExpansion:L,updateParams:z,level:0},e.id))]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Brands"}),(0,a.jsxs)("ul",{className:"space-y-2",children:[(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>z("brand",""),className:`w-full text-left py-1.5 text-sm ${!S?"text-primary font-medium":"text-gray-600 hover:text-gray-900"}`,children:"All Brands"})}),h.map(e=>(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>z("brand",e.slug),className:`w-full text-left py-1.5 text-sm ${S===e.slug?"text-primary font-medium":"text-gray-600 hover:text-gray-900"}`,children:[e.name,e.product_count>0&&(0,a.jsxs)("span",{className:"text-gray-400 ml-1",children:["(",e.product_count,")"]})]})},e.id))]})]})]}),(0,a.jsxs)("div",{className:"flex-shrink-0 space-y-4 pt-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Price Range"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"number",placeholder:"Min",value:A,onChange:e=>z("min_price",e.target.value),className:"w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),(0,a.jsx)("span",{className:"text-gray-400 self-center",children:"-"}),(0,a.jsx)("input",{type:"number",placeholder:"Max",value:M,onChange:e=>z("max_price",e.target.value),className:"w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),$&&(0,a.jsx)("button",{onClick:E,className:"w-full py-3 text-sm font-medium text-primary border border-primary rounded-lg hover:bg-primary hover:text-white transition-colors",children:"Clear All Filters"})]})]})}),(0,a.jsxs)("main",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6 bg-white rounded-xl p-4 shadow-sm",children:[(0,a.jsxs)("button",{onClick:()=>_(!0),className:"lg:hidden flex items-center gap-2 text-sm font-medium text-gray-700",children:[(0,a.jsx)(d.SlidersHorizontal,{className:"h-4 w-4"}),"Filters",$&&(0,a.jsx)("span",{className:"w-5 h-5 bg-primary text-white text-xs rounded-full flex items-center justify-center",children:"!"})]}),(0,a.jsxs)("div",{className:"hidden lg:flex items-center gap-2 flex-wrap",children:[C&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-sm rounded-full",children:[o.find(e=>e.slug===C)?.name,(0,a.jsx)("button",{onClick:()=>z("category",""),className:"hover:text-primary",children:(0,a.jsx)(i.X,{className:"h-3 w-3"})})]}),S&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-sm rounded-full",children:[h.find(e=>e.slug===S)?.name,(0,a.jsx)("button",{onClick:()=>z("brand",""),className:"hover:text-primary",children:(0,a.jsx)(i.X,{className:"h-3 w-3"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("label",{className:"text-sm text-gray-500",children:"Sort by:"}),(0,a.jsx)("select",{value:P,onChange:e=>z("sort",e.target.value),className:"px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white",children:u.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),f?(0,a.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6",children:[...Array(6)].map((e,t)=>(0,a.jsx)("div",{className:"bg-gray-100 rounded-2xl h-[400px] animate-pulse"},t))}):n.length>0?(0,a.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6",children:n.map(e=>(0,a.jsx)(m.default,{product:e},e.id))}):(0,a.jsxs)("div",{className:"text-center py-20 bg-white rounded-2xl",children:[(0,a.jsx)("div",{className:"text-gray-400 mb-4",children:(0,a.jsx)(l.Filter,{className:"h-16 w-16 mx-auto"})}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No products found"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6",children:"Try adjusting your filters or search terms."}),(0,a.jsx)("button",{onClick:E,className:"px-6 py-3 bg-primary text-white font-medium rounded-full hover:bg-primary-dark transition-colors",children:"Clear Filters"})]}),j>12&&(0,a.jsx)("div",{className:"flex justify-center mt-12",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[F>1&&(0,a.jsx)("button",{onClick:()=>z("page",(F-1).toString()),className:"px-4 py-2 border rounded-lg text-sm font-medium hover:bg-gray-50",children:"Previous"}),(0,a.jsxs)("span",{className:"px-4 py-2 text-sm text-gray-500",children:["Page ",F," of ",Math.ceil(j/12)]}),F<Math.ceil(j/12)&&(0,a.jsx)("button",{onClick:()=>z("page",(F+1).toString()),className:"px-4 py-2 border rounded-lg text-sm font-medium hover:bg-gray-50",children:"Next"})]})})]})]})}),v&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 lg:hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>_(!1)}),(0,a.jsxs)("div",{className:"absolute inset-y-0 left-0 w-full max-w-xs bg-white overflow-y-auto",children:[(0,a.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"font-semibold text-lg",children:"Filters"}),(0,a.jsx)("button",{onClick:()=>_(!1),children:(0,a.jsx)(i.X,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"p-4 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Categories"}),(0,a.jsxs)("ul",{className:"space-y-1",children:[(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>{z("category",""),_(!1)},className:`w-full text-left py-1.5 text-sm ${!C?"text-primary font-medium":"text-gray-600"}`,children:"All Categories"})}),o.map(e=>(0,a.jsx)(p,{category:e,categorySlug:C,expandedCategories:w,toggleCategoryExpansion:L,updateParams:(e,a)=>{z(e,a),_(!1)},level:0},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Brands"}),(0,a.jsxs)("ul",{className:"space-y-2",children:[(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>{z("brand",""),_(!1)},className:`w-full text-left py-1.5 text-sm ${!S?"text-primary font-medium":"text-gray-600"}`,children:"All Brands"})}),h.map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>{z("brand",e.slug),_(!1)},className:`w-full text-left py-1.5 text-sm ${S===e.slug?"text-primary font-medium":"text-gray-600"}`,children:e.name})},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Price Range"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"number",placeholder:"Min",value:A,onChange:e=>z("min_price",e.target.value),className:"w-full px-3 py-2 text-sm border rounded-lg"}),(0,a.jsx)("span",{className:"text-gray-400 self-center",children:"-"}),(0,a.jsx)("input",{type:"number",placeholder:"Max",value:M,onChange:e=>z("max_price",e.target.value),className:"w-full px-3 py-2 text-sm border rounded-lg"})]})]}),$&&(0,a.jsx)("button",{onClick:()=>{E(),_(!1)},className:"w-full py-3 text-sm font-medium text-primary border border-primary rounded-lg",children:"Clear All Filters"})]})]})]})]})}function h(){let e,r=(0,t.c)(1);return r[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,a.jsx)(o.Loader2,{className:"h-8 w-8 animate-spin text-orange-500"})}),children:(0,a.jsx)(g,{})}),r[0]=e):e=r[0],e}e.s(["default",()=>h])}]);